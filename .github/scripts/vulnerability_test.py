import shlex
import subprocess
import time

port = "1883"
addr = "127.0.0.1"
data_path = ".github/scripts/vul_dataset/"
datafiles = ['vul_data1.raw', 'vul_data2.raw', 'vul_data3.raw', 'vul_data4.raw',
             'vul_data5.raw', 'vul_data6.raw', 'vul_data7.raw', 'vul_data8.raw']

def vul_test():
    for file in datafiles:
        vul_cmd = "nc " + addr +" "+ port + " < " + data_path + file
        vul_test_cmd = shlex.split(vul_cmd)
        process = subprocess.Popen(vul_test_cmd,
                               stdout=subprocess.PIPE,
                               universal_newlines=True)
        time.sleep(1)
        process.terminate()